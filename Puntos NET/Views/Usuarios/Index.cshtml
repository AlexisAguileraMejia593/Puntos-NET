@model ML.Usuario
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href=" https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script src=" https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
<div class="text-center">
    <h2>Registros de la tabla</h2>
    <h5>Usuario</h5>
</div>
<hr />
<a href="@Url.Action("Form","Usuarios")" class="btn btn-success">Agregar </a>
@if (Model.Usuarios.Count > 0)
{
    <table class="table table-bordered">
        <thead>
            <!-- On rows -->
            <tr class="bg-warning">
                <th>Editar</th>
                <th>Nombre</th>
                <th>Apellidos</th>
                <th>UserName</th>
                <th>Detalles</th>
                <th>Eliminar</th>
                <!-- On cells (`td` or `th`) -->
            </tr>
        </thead>
        <tbody>
            @foreach (ML.Usuario usuarios in Model.Usuarios)
            {
                <tr>
                    <td><a class="btn btn-warning" href="@Url.Action("Form", "Usuarios", new { IdUsuario = usuarios.IdUsuario })"><i class="fa-solid fa-pencil fa-bounce" style="color: #332774;"></i></a></td>
                    <td>@usuarios.Nombre</td>
                    <td>@usuarios.ApellidoPaterno @usuarios.ApellidoMaterno</td>
                    <td>@usuarios.UserName</td>
                    <td>
                        <button type="button" class="btn btn-info" onclick="GetAll()"><i class="fa-solid fa-circle-info"></i></button>
                    </td>

                    <td><a class="btn btn-danger" href="@Url.Action("Delete", "Usuarios", new { IdUsuario = usuarios.IdUsuario,})" onclick="return confirm('Estas seguro de que quieres eliminar este registro');"> <i class="fa-solid fa-trash fa-beat" style="color: black;"></i></a></td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="alert alert-warning" role="alert">
        No existen registros en la tabla :(
    </div>
}
@section Scripts{
    <script type="text/javascript">
        function GetAll() {
            $.ajax({
                type: 'GET',
                    url: 'http://localhost:5257/api/Usuarios/GetAll',
                dataType: 'JSON',
                data: "",
                success: function (result) { // codigo de estado de 200 a 299
                    $.each(result.Objects, function (i, empleado) {
                        var fila =
                            "<tr>"
                            + "<td>" + '<a href="#" class = "btn btn-warning" onclick="Formulario(' + empleado.IdEmpleado + ')">' + "EDITAR" + '</a>' + "</td>"
                            + "<td>" + empleado.IdEmpleado + "</td>"
                            + "<td>" + empleado.NumeroNomina + "</td>"
                            + "<td>" + empleado.Nombre + "</td>"
                            + "<td>" + empleado.ApellidoPaterno + "</td>"
                            + "<td>" + empleado.ApellidoMaterno + "</td>"
                            + "<td>" + empleado.Estado.IdEntidad + "</td>"
                            + "<td>" + empleado.Estado.Estado + "</td>"
                            + "<td>" + '<a href="#" class = "btn btn-danger" onclick="Delete(' + empleado.IdEmpleado + ')">' + "ELIMINAR" + '</a>' + "</td>"
                            + "</tr>";

                        $("#tblEmpleado tbody").append(fila);
                    });
                },
                error: function (result) {  // codigo de estado 400 o 500
                    alert("Ocurrio un error al realizar la consulta: " + result.responseJSON.ErrorMessage);
                }
            });
        };
        function GetById(idEmpleado) {
            $.ajax({
                type: 'GET',
                url: 'http://localhost:5257/api/Usuarios/GetById' + idEmpleado,
                dataType: 'JSON',
                data: "",
                success: function (result) {
                    $('#txtIdEmpleado').val(result.Object.IdEmpleado);
                    $('#txtNumeroNomina').val(result.Object.NumeroNomina);
                    $('#txtNombre').val(result.Object.Nombre);
                    $('#txtApellidoPaterno').val(result.Object.ApellidoPaterno);
                    $('#txtApellidoMaterno').val(result.Object.ApellidoMaterno);
                    $('#ddlEntidadFederativa').val(result.Object.Estado.IdEntidad);
                },
                error: function (result) {  // codigo de estado 400 o 500
                    alert("Ocurrio un error al realizar la consulta: " + result.responseJSON.ErrorMessage);
                }
            });
        };
    </script>
}